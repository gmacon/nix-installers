<h1
id="nix-installers-for-legacy-imperative-distributions">Nix-installers
for legacy (imperative) distributions</h1>
<p>Getting Nix onto legacy distributions can be difficult and the
official installer is not always a viable option, especially when
considering reproducibility and automation.</p>
<p>This approach is different from others in that we:</p>
<ul>
<li><p>Package using distribution-native packaging formats
(<code>deb</code>/<code>rpm</code>). And use these packages to manage
systemd and environment integrations.</p></li>
<li><p>Create a /nix/store imperatively as a postinstall hook. This uses
a prepopulated Nix store embedded inside the distribution-native
packaging format.</p></li>
<li><p>Properly cleans up after uninstallation. We use package manager
hooks to cleanly remove any traces of Nix post removal.</p></li>
</ul>
<p>To achieve a reproducible setup for these distributions that doesnâ€™t
rely on pulling files from the internet at install-time.</p>
<p>These installer packages are intended to be used in a one-shot
fashion to bootstrap the Nix installation, and then let Nix deal with
managing itself from that point on.</p>
<h2 id="usage">Usage</h2>
<h3 id="prebuilt-installers">Prebuilt installers</h3>
<ul>
<li>Deb
<ul>
<li>aarch64: <a
href="./aarch64/nix-multi-user-2.8.0.deb">nix-multi-user-2.8.0.deb</a>
<code>(74b7a1784c3a520510b8d51e6c6cba73edc7664d1ed21ef6dbfef6a6118e413c)</code></li>
<li>x86_64: <a
href="./x86_64/nix-multi-user-2.8.0.deb">nix-multi-user-2.8.0.deb</a>
<code>(e05fc60adb8975d86d6af1b7eef3445170e49150947ab26a751741d98e13f7fb)</code></li>
</ul></li>
<li>Pacman
<ul>
<li>aarch64: <a
href="./aarch64/nix-multi-user-2.8.0.pkg.tar.zst">nix-multi-user-2.8.0.pkg.tar.zst</a>
<code>(ee07da5656a407e10c155adb191c7b9208174670e9d5796c1f2e68c3b80cd0fe)</code></li>
<li>x86_64: <a
href="./x86_64/nix-multi-user-2.8.0.pkg.tar.zst">nix-multi-user-2.8.0.pkg.tar.zst</a>
<code>(7fc6a55738ef9f61c8fde9a780b7811cf4ea00ec013bdb2c06185776bf339806)</code></li>
</ul></li>
<li>Rpm
<ul>
<li>aarch64: <a
href="./aarch64/nix-multi-user-2.8.0.rpm">nix-multi-user-2.8.0.rpm</a>
<code>(0f0c086a7c9b0927995259d52f6320fcd70634e63bd335526e5ad7460cae2bfa)</code></li>
<li>x86_64: <a
href="./x86_64/nix-multi-user-2.8.0.rpm">nix-multi-user-2.8.0.rpm</a>
<code>(4ba113c8857c40704da3504d52e5bf5af21143246b2b4ffdb18b667e5e29e9a3)</code></li>
</ul></li>
</ul>
<h3 id="flakes">Flakes</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remote flake</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> nix build github:nix-community/nix-installers#deb</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> nix build github:nix-community/nix-installers#pacman</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> nix build github:nix-community/nix-installers#rpm</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># In a cloned repository</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> nix build .#deb</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> nix build .#pacman</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> nix build .#rpm</span></code></pre></div>
<h3 id="classic-nix">Classic Nix</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In a cloned repository</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> nix-build ./. <span class="at">-A</span> deb</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> nix-build ./. <span class="at">-A</span> pacman</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> nix-build ./. <span class="at">-A</span> rpm</span></code></pre></div>
<h2 id="contributing">Contributing</h2>
<p><a
href="https://github.com/nix-community/nix-installers">https://github.com/nix-community/nix-installers</a></p>
